# Apache Thrift Test

Небольшой кросс-платформенный тест для библиотеки и компилятора Apache Thrift

## Сборка
### Требования
* **Компилятор C++** с поддержкой стандарта C++11 (проверено на компиляторах **clang**(MacOS), **GNU g++**(linux) и **MSVC 14/15 (Visual Studio 2015/2017)**(Windows)).
* **GIT** (в процессе сборки автоматически загружается последняя версия **Apache Thrift**.
* **cmake** версии 3.1 и выше (для сборки под MSVC 15 (Visual Studio 2017) версия не ниже 3.7)
* **boost** - только заголовочные файлы.
* **FLEX/BISON** - для сборки **thrift-compiler**, только под **Linux/MacOS**. Под Windows используется prebuild-версия компилятора, распространяемая с **Apache Thrift**.
  * В комплект **XCode** для **MacOS** входят **FLEX** и **BISON**, однако устаревших версий. Версии **FLEX** достаточно для сборки **thrift-compiler**, однако версия **BISON** (2.3) слишком старая. Свежу версию **BISON** можно взять из комплектов пакетов для **MacOS** [MacPorts](https://www.macports.org/) или [Homebrew](https://brew.sh/). При сборке через **QtCreator** необходимо убедиться, что путь к обновлённым версиям (обычно `/opt/local/bin`) установлен в переменных окружения до стандартного пути (`/usr/bin`).

### Linux/MacOS
Создаём папку для сборки, переходим в неё и выполняем последовательно команды:
```
cmake -DCMAKE_BUILD_TYPE=Release <path_to_project>
cmake --build .
```
`-DCMAKE_BUILD_TYPE=Release` можно опустить или указать другой тип конфигурации, допускаемых **cmake** (см. [CMAKE_BUILD_TYPE](https://cmake.org/cmake/help/v3.7/variable/CMAKE_BUILD_TYPE.html))
### Windows
* Сборка с помощью среды **Visual Studio** (с возможностью последущей отладки в среде)
  * Создаём папку для сборки, переходим в неё и выполняем в ней команду:
  ```
  cmake -DCMAKE_CONFIGURATION_TYPES=Debug;Release -G "Visual Studio 14 2015 Win64" <path_to_project>
  cmake --build .
  ```
  Параметр после `-G` - имя генератора (для какой студии и какой платформы генерируем проект). Список допустимых генераторов см. [здесь](https://cmake.org/cmake/help/v3.7/manual/cmake-generators.7.html#visual-studio-generators).
  * Запускаем Visual Studio и открываем solution, созданный в выбранной папке. Solution создаётся *умный*, т.е. он автоматически отслеживает изменения CMake-файлов, и, при необходимости, перегенерирует сам себя.

* Сборка с помошью **NMAKE** из командной строки
  * Запускаем командную строку и выполняем настройку переменных среды для желаемого компилятора. Обычно это делается с помощью файла, установленно в папке с Visual Studio. Для VS 2015, установленной по умолчанию, это `C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat`. Например, для сборки 64-битной версии под VS 2015 это будет команда:
    ```
    "С:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat" amd64
    ```
  * Следуем инструкциям для **Linux/MacOS**.
  
* Сборка с помощью **cmake-gui**

  Запускаем **cmake-gui**, указываем путь к проекту и папку для результатов. Дальше он всё сделает сам - предложит выбор генератора, и после создания проектов предложит открыть их в **Visual Studio**.

* Сборка с помощью **QtCreator**

  Самый простой вариант. Просто говорим "Load project..." - дальше он всё сделает сам.
